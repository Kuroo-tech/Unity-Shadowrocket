#!url=https://raw.githubusercontent.com/Kuroo-tech/Unity-Shadowrocket/main/unity.module
#!name=All-In-One
#!desc=Mở khóa Locket Gold, Spotify Premium (Extreme), YouTube Premium (PIP, chạy nền, 4K) & BlockAd (Nâng cao) & Cloudflare WARP
#!author=unity
# Update: 16/08/2025
#!icon=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png

[MITM]
hostname = %APPEND% api.revenuecat.com,spclient.wg.spotify.com,redirector*.googlevideo.com,*.googlevideo.com,www.youtube.com,s.youtube.com,youtubei.googleapis.com,adservice.google.com,securepubads.g.doubleclick.net,app.bilibili.com,api.live.bilibili.com,api.vc.bilibili.com,api.bilibili.com,manga.bilibili.com,grpc.biliapi.net,api.biliapi.net,api-mobile.soundcloud.com,api.cloudflareclient.com, zero-trust-client.cloudflareclient.com

[Rule]
AND,((DOMAIN-SUFFIX,googlevideo.com), (PROTOCOL,UDP)),REJECT
AND,((DOMAIN,youtubei.googleapis.com), (PROTOCOL,UDP)),REJECT
DOMAIN-SUFFIX,ads.youtube.com,REJECT
DOMAIN-SUFFIX,adservice.google.com,REJECT
DOMAIN-SUFFIX,doubleclick.net,REJECT
DOMAIN-SUFFIX,googleads.g.doubleclick.net,REJECT

https://www.grammarly.com/ai/ai-writing-tools/paragraph-rewriter
(^https?://[\w-]+\.googlevideo\.com/(?!dclk_video_ads).+?)&ctier=L(&.+?),ctier,(.+) $1$2$3 302
^https?://[\w-]+\.googlevideo\.com/(?!(dclk_video_ads|videoplayback?)).+&oad _ reject-200
^https?://(www|s)\.youtube\.com/api/stats/ads _ reject-200
^https?://(www|s)\.youtube\.com/(pagead|ptracking) _ reject-200
^https?://s\.youtube\.com/api/stats/qoe\?adcontext _ reject-200
^https?://(www|s)\.youtube\.com/get_midroll_info _ reject-200
^https?://(www|s)\.youtube\.com/get_vmap _ reject-200
# Chặn yêu cầu lấy thông tin IP
^https?:\/\/app\.bilibili\.com\/x\/resource\/ip - reject
# Chặn từ khoá mặc định trong tìm kiếm
^https?:\/\/app\.bilibili\.com\/bilibili\.app\.interface\.v1\.Search\/Default - reject
# Chặn hoạt động (sự kiện) trang chủ bên phải
^https?:\/\/app\.bilibili\.com\/x\/resource\/top\/activity - reject-dict
# Gỡ quảng cáo mở app
^https://app.bilibili.com/x/v2/splash/show - reject-dict
# Chặn từ khoá tìm kiếm gợi ý
^https://app.bilibili.com/x/v2/search/defaultwords - reject-dict
# Chặn báo cáo quảng cáo VIP
^https?:\/\/api\.bilibili\.com\/x\/vip\/ads\/material\/report - reject-dict
# Chặn quảng cáo trong thẻ phim
^https://api.bilibili.com/pgc/season/player/cards - reject-dict
# Bỏ giới hạn SIM khu vực
(^https?:\/\/app\.biliintl.com\/intl\/.+)(&sim_code=\d+)(.+) - 302 $1$3
# Chặn gợi ý từ tìm kiếm
^https?:\/\/api\.vc\.bilibili\.com\/search_svr\/v\d\/Search\/recommend_words - reject
# Chặn chủ đề ở mục “Động thái”
^https?:\/\/api\.vc\.bilibili\.com\/topic_svr\/v1\/topic_svr - reject-dict
# Chặn đề xuất quảng bá phim
^https?:\/\/api\.bilibili\.com\/pgc\/season\/app\/related\/recommend\? - reject-dict
# Chặn quảng cáo trong truyện tranh
^https?:\/\/manga\.bilibili\.com\/twirp\/comic\.v\d\.Comic\/(Flash|ListFlash) - reject-dict

[Script]
# ~ Locket Gold Unlock
revenuecat = type=http-response, pattern=^https:\/\/api\.revenuecat\.com\/.+\/(receipts$|subscribers\/[^/]+$), script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/main/js/locket/Locket.js, requires-body=true, max-size=-1, timeout=60
deleteHeader = type=http-request, pattern=^https:\/\/api\.revenuecat\.com\/.+\/(receipts|subscribers), script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/main/js/locket/deleteHeader.js, timeout=60

# ~ Spotify Premium Unlock (Thêm Extreme Quality)
spotify-proto = type=http-response, pattern=^https:\/\/spclient\.wg\.spotify\.com\/(bootstrap\/v1\/bootstrap|user-customization-service\/v1\/customize)$, requires-body=1, binary-body-mode=1, max-size=0, script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/main/js/spotify/spotify.js, script-update-interval=0

# ~ YouTube Premium Unlock & BlockAd (Thêm PIP, chạy nền, chặn giới hạn độ phân giải)
youtube.response = type=http-response,pattern=^https://youtubei\.googleapis\.com/youtubei/v1/(browse|next|player|search|reel/reel_watch_sequence|guide|account/get_setting|get_watch),requires-body=1,max-size=-1,binary-body-mode=1,engine=script,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/main/js/Yt/youtube.response.preview.js,argument="{\"lyricLang\":\"{{{ngôn ngữ dịch lời bài hát}}}\",\"captionLang\":\"{{{ngôn ngữ dịch phụ đề}}}\",\"blockUpload\":{{{chặn nút tải lên}}},\"blockImmersive\":{{{chặn nút chọn đoạn}}},\"enablePIP\":true,\"enableBackgroundPlay\":true,\"unlockResolution\":true,\"debug\":{{{kích hoạt chế độ gỡ lỗi}}}}"

# Gỡ quảng cáo trang phim
cinema_ads=type=http-response,pattern=^https?:\/\/api\.(bilibili|biliapi)\.(com|net)\/pgc\/page\/cinema\/tab\?,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ preload splash quảng cáo mở app
splash_ads=type=http-response,pattern=^https:\/\/app\.bilibili\.com\/x\/v2\/splash\/list,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ giao diện skin ép buộc
forced_skin=type=http-response,pattern=^https?:\/\/app\.bilibili\.com\/x\/resource\/show\/skin\?,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Mở khóa 1080P cao bitrate + 4K
quality_unlock=type=http-response,pattern=^https?:\/\/app\.bilibili\.com\/x\/v2\/account\/myinfo\?,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ quảng cáo trong tìm kiếm trending
search_square=type=http-response,pattern=^https://app.bilibili.com/x/v2/search/square,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ quảng cáo đề xuất trang chính
feed_ads=type=http-response,pattern=^https?:\/\/app\.bilibili\.com\/x\/v2\/feed\/index,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ quảng cáo ở mục "Theo dõi"
bangumi_ads=type=http-response,pattern=^https?:\/\/api\.(bilibili|biliapi)\.(com|net)\/pgc\/page\/bangumi,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ quảng cáo livestream
live_ads=type=http-response,pattern=^https?:\/\/api\.live\.bilibili\.com\/xlive\/app-room\/v1\/index\/getInfoByRoom,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ quảng cáo tab động thái
dynamic_ads=type=http-response,pattern=^https?:\/\/api\.vc\.bilibili\.com\/dynamic_svr\/v1\/dynamic_svr\/dynamic_(history|new)\?,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Tùy chỉnh tab hiển thị trên trang chính
tab_customize=type=http-response,pattern=^https?:\/\/app\.bilibili\.com\/x\/resource\/show\/tab,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Tùy chỉnh nội dung trang "Của tôi"
mine_customize=type=http-response,pattern=^https?:\/\/app\.bilibili\.com\/x\/v2\/account\/mine,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/bilibili/bilibili_json.js
# Gỡ quảng cáo định dạng protobuf
proto_ads=type=http-response,pattern=^https:\/\/app\.bilibili\.com\/bilibili\.app\.(view\.v1\.View\/View|dynamic\.v2\.Dynamic\/DynAll)$,requires-body=1,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/bilibili-proto.js
# Gỡ quảng cáo động thái (script riêng)
dynamic_ads_alt=type=http-response,pattern=^https://app\.bilibili\.com/bilibili\.app\.dynamic\.v2\.Dynamic/DynAll$,requires-body=1,script-path=https://raw.githubusercontent.com/yjqiang/surge_scripts/main/scripts/bilibili/bilibili_dynamic.js
#SoundCloud
SoundCloudGo+=type=http-response,pattern=https://api-mobile.soundcloud.com/configuration/ios,requires-body=1,script-path=https://raw.githubusercontent.com/dhungx/modules-shadowrocket/refs/heads/main/js/SoundCloud/soundcloud.js
# WARP Panel
#!PROFILE-VERSION-REQUIRED 10 ☁ WARP Panel = type=generic, timeout=10, script-path=https://raw.githubusercontent.com/VirgilClyne/Cloudflare/main/js/1.1.1.1.panel.js
# WARP Personal
☁ WARP Personal Request = type=http-request,pattern=^https?:\/\/(api|zero-trust-client)\.cloudflareclient\.com\/(.*)\/reg\/[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$, requires-body=1, script-path=https://raw.githubusercontent.com/VirgilClyne/Cloudflare/main/js/1.1.1.1.request.js
☁ WARP Personal Response = type=http-response,pattern=^https?:\/\/(api|zero-trust-client)\.cloudflareclient\.com\/(.*)\/reg\/[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$, requires-body=1, engine=webview, script-path=https://raw.githubusercontent.com/VirgilClyne/Cloudflare/main/js/1.1.1.1.response.js
# Zero Trust Client (Cloudflare for Teams)
☁ WARP Teams Request = type=http-request,pattern=^https?:\/\/(api|zero-trust-client)\.cloudflareclient\.com\/(.*)\/reg\/t\.[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$, requires-body=1, script-path=https://raw.githubusercontent.com/VirgilClyne/Cloudflare/main/js/1.1.1.1.request.js
☁ WARP Teams Response = type=http-response,pattern=^https?:\/\/(api|zero-trust-client)\.cloudflareclient\.com\/(.*)\/reg\/t\.[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$, requires-body=1, engine=webview, script-path=https://raw.githubusercontent.com/VirgilClyne/Cloudflare/main/js/1.1.1.1.response.js

[Host]
# refer: https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/deployment/firewall/#warp-ingress-ip
engage.cloudflareclient.com = 162.159.192.1, 162.159.192.2, 162.159.192.3, 162.159.192.4, 162.159.192.5, 162.159.192.6, 162.159.192.7, 162.159.192.8, 162.159.192.9, 162.159.192.10, 162.159.193.1, 162.159.193.2, 162.159.193.3, 162.159.193.4, 162.159.193.5, 162.159.193.6, 162.159.193.7, 162.159.193.8, 162.159.193.9, 162.159.193.10, 162.159.194.1, 162.159.194.2, 162.159.194.3, 162.159.194.4, 162.159.194.5, 162.159.194.6, 162.159.194.7, 162.159.194.8, 162.159.194.9, 162.159.194.10, 162.159.195.1, 162.159.195.2, 162.159.195.3, 162.159.195.4, 162.159.195.5, 162.159.195.6, 162.159.195.7, 162.159.195.8, 162.159.195.9, 162.159.195.10, 2606:4700:d0::a29f:c001, 2606:4700:d0::a29f:c002, 2606:4700:d0::a29f:c003, 2606:4700:d0::a29f:c004, 2606:4700:d0::a29f:c005, 2606:4700:d0::a29f:c006, 2606:4700:d0::a29f:c007, 2606:4700:d0::a29f:c008, 2606:4700:d0::a29f:c009, 2606:4700:d0::a29f:c010, 2606:4700:d0::a29f:c101, 2606:4700:d0::a29f:c102, 2606:4700:d0::a29f:c103, 2606:4700:d0::a29f:c104, 2606:4700:d0::a29f:c105, 2606:4700:d0::a29f:c106, 2606:4700:d0::a29f:c107, 2606:4700:d0::a29f:c108, 2606:4700:d0::a29f:c109, 2606:4700:d0::a29f:c010, 2606:4700:d1::a29f:c001, 2606:4700:d1::a29f:c002, 2606:4700:d1::a29f:c003, 2606:4700:d1::a29f:c004, 2606:4700:d1::a29f:c005, 2606:4700:d1::a29f:c006, 2606:4700:d1::a29f:c007, 2606:4700:d1::a29f:c008, 2606:4700:d1::a29f:c009, 2606:4700:d1::a29f:c010, 2606:4700:d1::a29f:c101, 2606:4700:d1::a29f:c102, 2606:4700:d1::a29f:c103, 2606:4700:d1::a29f:c104, 2606:4700:d1::a29f:c105, 2606:4700:d1::a29f:c106, 2606:4700:d1::a29f:c107, 2606:4700:d1::a29f:c108, 2606:4700:d1::a29f:c109, 2606:4700:d1::a29f:c010 // Cloudflare WARP endpoint (Dual-stack)
engage.nanocat.cloud = 162.159.192.1, 162.159.192.2, 162.159.192.3, 162.159.192.4, 162.159.192.5, 162.159.192.6, 162.159.192.7, 162.159.192.8, 162.159.192.9, 162.159.192.10, 162.159.193.1, 162.159.193.2, 162.159.193.3, 162.159.193.4, 162.159.193.5, 162.159.193.6, 162.159.193.7, 162.159.193.8, 162.159.193.9, 162.159.193.10, 162.159.194.1, 162.159.194.2, 162.159.194.3, 162.159.194.4, 162.159.194.5, 162.159.194.6, 162.159.194.7, 162.159.194.8, 162.159.194.9, 162.159.194.10, 162.159.195.1, 162.159.195.2, 162.159.195.3, 162.159.195.4, 162.159.195.5, 162.159.195.6, 162.159.195.7, 162.159.195.8, 162.159.195.9, 162.159.195.10, 2606:4700:d0::a29f:c001, 2606:4700:d0::a29f:c002, 2606:4700:d0::a29f:c003, 2606:4700:d0::a29f:c004, 2606:4700:d0::a29f:c005, 2606:4700:d0::a29f:c006, 2606:4700:d0::a29f:c007, 2606:4700:d0::a29f:c008, 2606:4700:d0::a29f:c009, 2606:4700:d0::a29f:c010, 2606:4700:d0::a29f:c101, 2606:4700:d0::a29f:c102, 2606:4700:d0::a29f:c103, 2606:4700:d0::a29f:c104, 2606:4700:d0::a29f:c105, 2606:4700:d0::a29f:c106, 2606:4700:d0::a29f:c107, 2606:4700:d0::a29f:c108, 2606:4700:d0::a29f:c109, 2606:4700:d0::a29f:c010, 2606:4700:d1::a29f:c001, 2606:4700:d1::a29f:c002, 2606:4700:d1::a29f:c003, 2606:4700:d1::a29f:c004, 2606:4700:d1::a29f:c005, 2606:4700:d1::a29f:c006, 2606:4700:d1::a29f:c007, 2606:4700:d1::a29f:c008, 2606:4700:d1::a29f:c009, 2606:4700:d1::a29f:c010, 2606:4700:d1::a29f:c101, 2606:4700:d1::a29f:c102, 2606:4700:d1::a29f:c103, 2606:4700:d1::a29f:c104, 2606:4700:d1::a29f:c105, 2606:4700:d1::a29f:c106, 2606:4700:d1::a29f:c107, 2606:4700:d1::a29f:c108, 2606:4700:d1::a29f:c109, 2606:4700:d1::a29f:c010 // Cloudflare WARP endpoint (Dual-stack)

[Panel]
☁ WARP Panel = title="{{{title}}}", icon="{{{icon}}}", "icon-color": "{{{icon-color}}}", script-name=☁ WARP Panel
